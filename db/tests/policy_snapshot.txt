public|audit_events|ae_select_org_admin|SELECT|(((actor_org_id = (NULLIF(current_setting('request.org_id'::text, true), ''::text))::uuid) AND (current_setting('request.org_status'::text, true) = 'approved'::text) AND (current_setting('request.org_role'::text, true) = ANY (ARRAY['admin'::text, 'owner'::text]))) OR (current_setting('request.platform_role'::text, true) = 'super_admin'::text))|
public|audit_events|ae_select_self|SELECT|(actor_user_id = (NULLIF(current_setting('request.user_id'::text, true), ''::text))::uuid)|
public|invitations|inv_insert_admin_mfa|INSERT||(((organization_id = (NULLIF(current_setting('request.org_id'::text, true), ''::text))::uuid) AND (current_setting('request.org_status'::text, true) = 'approved'::text) AND (current_setting('request.org_role'::text, true) = ANY (ARRAY['admin'::text, 'owner'::text])) AND (COALESCE(current_setting('request.mfa'::text, true), 'off'::text) = 'on'::text)) OR (current_setting('request.platform_role'::text, true) = 'super_admin'::text))
public|invitations|inv_select_org_admin|SELECT|((((organization_id = (NULLIF(current_setting('request.org_id'::text, true), ''::text))::uuid) AND (current_setting('request.org_status'::text, true) = 'approved'::text) AND (current_setting('request.org_role'::text, true) = ANY (ARRAY['admin'::text, 'owner'::text])))) OR (((email)::text = NULLIF(current_setting('request.clerk_user_email'::text, true), ''::text))) OR ((current_setting('request.platform_role'::text, true) = 'super_admin'::text)))|
public|invitations|inv_update_admin_mfa_revoke|UPDATE|(((organization_id = (NULLIF(current_setting('request.org_id'::text, true), ''::text))::uuid) AND (current_setting('request.org_status'::text, true) = 'approved'::text) AND (current_setting('request.org_role'::text, true) = ANY (ARRAY['admin'::text, 'owner'::text])) AND (COALESCE(current_setting('request.mfa'::text, true), 'off'::text) = 'on'::text)) OR (current_setting('request.platform_role'::text, true) = 'super_admin'::text))|(((organization_id = (NULLIF(current_setting('request.org_id'::text, true), ''::text))::uuid) AND (current_setting('request.org_status'::text, true) = 'approved'::text) AND (current_setting('request.org_role'::text, true) = ANY (ARRAY['admin'::text, 'owner'::text])) AND (COALESCE(current_setting('request.mfa'::text, true), 'off'::text) = 'on'::text) AND (status = ANY (ARRAY['pending'::invitation_status, 'revoked'::invitation_status]))) OR (current_setting('request.platform_role'::text, true) = 'super_admin'::text))
public|invitations|inv_update_invitee_accept|UPDATE|((email)::text = NULLIF(current_setting('request.clerk_user_email'::text, true), ''::text))|(((email)::text = NULLIF(current_setting('request.clerk_user_email'::text, true), ''::text)) AND (status = ANY (ARRAY['pending'::invitation_status, 'accepted'::invitation_status])))
public|memberships|ms_select_org_admin|SELECT|(((organization_id = (NULLIF(current_setting('request.org_id'::text, true), ''::text))::uuid) AND (current_setting('request.org_status'::text, true) = 'approved'::text) AND (current_setting('request.org_role'::text, true) = ANY (ARRAY['admin'::text, 'owner'::text]))) OR (current_setting('request.platform_role'::text, true) = 'super_admin'::text))|
public|memberships|ms_select_self|SELECT|((user_id = (NULLIF(current_setting('request.user_id'::text, true), ''::text))::uuid) OR (current_setting('request.platform_role'::text, true) = 'super_admin'::text))|
public|memberships|ms_update_admin_mfa|UPDATE|(((organization_id = (NULLIF(current_setting('request.org_id'::text, true), ''::text))::uuid) AND (current_setting('request.org_status'::text, true) = 'approved'::text) AND (current_setting('request.org_role'::text, true) = ANY (ARRAY['admin'::text, 'owner'::text])) AND (COALESCE(current_setting('request.mfa'::text, true), 'off'::text) = 'on'::text)) OR (current_setting('request.platform_role'::text, true) = 'super_admin'::text))|(((organization_id = (NULLIF(current_setting('request.org_id'::text, true), ''::text))::uuid) AND (current_setting('request.org_status'::text, true) = 'approved'::text) AND (current_setting('request.org_role'::text, true) = ANY (ARRAY['admin'::text, 'owner'::text])) AND (COALESCE(current_setting('request.mfa'::text, true), 'off'::text) = 'on'::text)) OR (current_setting('request.platform_role'::text, true) = 'super_admin'::text))
public|organization_domains|org_domains_delete_admin_mfa|DELETE|((organization_id = (NULLIF(current_setting('request.org_id'::text, true), ''::text))::uuid) AND (current_setting('request.org_status'::text, true) = 'approved'::text) AND (current_setting('request.org_role'::text, true) = ANY (ARRAY['admin'::text, 'owner'::text])) AND (COALESCE(current_setting('request.mfa'::text, true), 'off'::text) = 'on'::text))|
public|organization_domains|org_domains_insert_admin_mfa|INSERT||((organization_id = (NULLIF(current_setting('request.org_id'::text, true), ''::text))::uuid) AND (current_setting('request.org_status'::text, true) = 'approved'::text) AND (current_setting('request.org_role'::text, true) = ANY (ARRAY['admin'::text, 'owner'::text])) AND (COALESCE(current_setting('request.mfa'::text, true), 'off'::text) = 'on'::text))
public|organization_domains|org_domains_select_approved|SELECT|((organization_id = (NULLIF(current_setting('request.org_id'::text, true), ''::text))::uuid) AND (current_setting('request.org_status'::text, true) = 'approved'::text))|
public|organization_domains|org_domains_update_admin_mfa|UPDATE|((organization_id = (NULLIF(current_setting('request.org_id'::text, true), ''::text))::uuid) AND (current_setting('request.org_status'::text, true) = 'approved'::text) AND (current_setting('request.org_role'::text, true) = ANY (ARRAY['admin'::text, 'owner'::text])) AND (COALESCE(current_setting('request.mfa'::text, true), 'off'::text) = 'on'::text))|((organization_id = (NULLIF(current_setting('request.org_id'::text, true), ''::text))::uuid) AND (current_setting('request.org_status'::text, true) = 'approved'::text) AND (current_setting('request.org_role'::text, true) = ANY (ARRAY['admin'::text, 'owner'::text])) AND (COALESCE(current_setting('request.mfa'::text, true), 'off'::text) = 'on'::text))
public|organizations|orgs_select_approved_context|SELECT|(((id = (NULLIF(current_setting('request.org_id'::text, true), ''::text))::uuid) AND (current_setting('request.org_status'::text, true) = 'approved'::text)) OR (current_setting('request.platform_role'::text, true) = 'super_admin'::text))|
public|organizations|orgs_update_admin_mfa|UPDATE|(((id = (NULLIF(current_setting('request.org_id'::text, true), ''::text))::uuid) AND (current_setting('request.org_status'::text, true) = 'approved'::text) AND (current_setting('request.org_role'::text, true) = ANY (ARRAY['admin'::text, 'owner'::text]))) OR (current_setting('request.platform_role'::text, true) = 'super_admin'::text))|((((id = (NULLIF(current_setting('request.org_id'::text, true), ''::text))::uuid) AND (current_setting('request.org_status'::text, true) = 'approved'::text) AND (current_setting('request.org_role'::text, true) = ANY (ARRAY['admin'::text, 'owner'::text])) AND (COALESCE(current_setting('request.mfa'::text, true), 'off'::text) = 'on'::text)) AND (NOT (orgnr IS DISTINCT FROM ( SELECT o2.orgnr
   FROM organizations o2
  WHERE (o2.id = organizations.id)))) AND (NOT (name IS DISTINCT FROM ( SELECT o2.name
   FROM organizations o2
  WHERE (o2.id = organizations.id)))) AND (NOT (org_form IS DISTINCT FROM ( SELECT o2.org_form
   FROM organizations o2
  WHERE (o2.id = organizations.id)))) AND (NOT (registered_at IS DISTINCT FROM ( SELECT o2.registered_at
   FROM organizations o2
  WHERE (o2.id = organizations.id)))) AND (NOT (status_text IS DISTINCT FROM ( SELECT o2.status_text
   FROM organizations o2
  WHERE (o2.id = organizations.id)))) AND (NOT (raw_brreg_json IS DISTINCT FROM ( SELECT o2.raw_brreg_json
   FROM organizations o2
  WHERE (o2.id = organizations.id))))) OR (current_setting('request.platform_role'::text, true) = 'super_admin'::text))
public|platform_admins|platform_admins_super|ALL|((current_setting('request.platform_role'::text, true) = 'super_admin'::text))|((current_setting('request.platform_role'::text, true) = 'super_admin'::text))
public|users|users_select_self|SELECT|(((clerk_user_id = current_setting('request.clerk_user_id'::text, true)) OR (current_setting('request.platform_role'::text, true) = 'super_admin'::text)))|
public|users|users_update_self_safe|UPDATE|(((clerk_user_id = current_setting('request.clerk_user_id'::text, true)) OR (current_setting('request.platform_role'::text, true) = 'super_admin'::text)))|(((((clerk_user_id = current_setting('request.clerk_user_id'::text, true)) AND (NOT (mfa_level IS DISTINCT FROM ( SELECT u2.mfa_level
   FROM users u2
  WHERE (u2.id = users.id)))))) OR (current_setting('request.platform_role'::text, true) = 'super_admin'::text)))
